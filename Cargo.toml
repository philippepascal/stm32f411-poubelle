[package]
name = "stm32f411-poubelle"
version = "0.1.0"
edition = "2024"


[dependencies]
# RTIC v2 needs a backend feature:
rtic = { version = "2.2", features = ["thumbv7-backend"] }

# Typical Cortex-M deps (versions shown are common & compatible)
cortex-m = "0.7"
cortex-m-rt = "0.7"

# Your existing HAL & PAC; make sure the stm32f411 feature is on
stm32f4xx-hal = { version = "0.22.1", features = ["stm32f411", "usb_fs"] }
# stm32f4xx-hal = { version = "0.22.1", features = ["rt", "usb_fs", "i2c"] }
alloc-cortex-m = "0.4"
# embedded-hal = "0.2"
embedded-hal = { version = "0.2.7", features = ["unproven"] }
# Peripheral Access Crate (auto-generated low-level regs for F411)
stm32f4 = { version = "0.16", features = ["stm32f411", "rt"] }
# High-level Hardware Abstraction Layer for stm32f4xx
panic-halt = "0.2"
usb-device = "0.3"
usbd-serial = "0.2.2"
vl53l1x-uld = "1.0.0"       # uses embedded-hal
#flash stuff
serde = { version = "1", default-features = false, features = ["derive"] }
postcard = { version = "1", default-features = false, features = ["use-crc"] } # pure no_std
crc32fast = { version = "1", default-features = false }                        # no_std
#monotonic for async tasks
rtic-monotonics = { version="2.1", features = ["cortex-m-systick"] }
systick-monotonic = "1.0"
dwt-systick-monotonic = "1.1"
rtic-time = "1"
fugit = "0.3"

[package.metadata.cortex-m-rt]
memory-x = true

[profile.release]
panic = "abort"
codegen-units = 1
debug = true
lto = true
opt-level = "s"

[profile.dev]
panic = "abort"